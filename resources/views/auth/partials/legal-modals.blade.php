{{-- Modales legales: Términos y Condiciones + Política de Privacidad --}}
<div id="modal-terms"
     data-modal-overlay
     class="hidden fixed inset-0 z-40 flex items-center justify-center px-4 py-6 bg-black/60 dark:bg-black/70">
    <div class="w-full max-w-2xl rounded-2xl border border-teal-400/70 bg-white dark:bg-slate-900 shadow-xl">
        <div class="flex items-start justify-between px-5 pt-4 pb-2">
            <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-50">
                Términos y Condiciones de Uso
            </h2>
            <button type="button"
                    class="ml-3 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"
                    data-modal-close="modal-terms">
                <span class="sr-only">Cerrar</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2">
                    <path d="M6 6l12 12M18 6L6 18"/>
                </svg>
            </button>
        </div>

        <div class="px-5 pb-4 max-h-72 overflow-y-auto text-sm leading-relaxed text-slate-700 dark:text-slate-200 space-y-3">
            <p class="text-justify">
                Los presentes Términos y Condiciones regulan el uso de la aplicación “Hydroponic System App”
                (en adelante, “la Aplicación”). Al acceder o utilizar la Aplicación, el usuario acepta cumplir
                con todas las disposiciones aquí establecidas. Si no está de acuerdo con estos términos, deberá
                abstenerse de utilizar la plataforma.
            </p>

            <h3 class="font-semibold text-teal-500">1. Uso General de la Aplicación</h3>
            <p class="text-justify">
                La Aplicación permite monitorear y controlar un sistema hidropónico mediante sensores,
                actuadores y registros en tiempo real. El usuario se compromete a utilizar el sistema de
                manera responsable y únicamente con fines legales.
            </p>

            <h3 class="font-semibold text-teal-500">2. Registro y Responsabilidad de la Cuenta</h3>
            <p class="text-justify">
                Para acceder a todas las funciones, el usuario debe registrarse proporcionando datos reales y actualizados.
                El usuario es responsable de la confidencialidad de su contraseña y de cualquier actividad realizada con su cuenta.
            </p>

            <h3 class="font-semibold text-teal-500">3. Responsabilidades del Usuario</h3>
            <p class="text-justify">
                El usuario se compromete a:
                <br>• No manipular la aplicación con fines maliciosos.
                <br>• Configurar adecuadamente su hardware hidropónico.
                <br>• Mantener actualizado su dispositivo y su conexión a Internet.
            </p>

            <h3 class="font-semibold text-teal-500">4. Limitaciones de Responsabilidad</h3>
            <p class="text-justify">
                La Aplicación depende de la conexión a Internet, servidores externos, sensores y hardware del usuario.
                No se garantiza disponibilidad continua del servicio ante fallos externos, cortes eléctricos o problemas técnicos.
            </p>

            <h3 class="font-semibold text-teal-500">5. Uso de Hardware y Actuadores</h3>
            <p class="text-justify">
                La activación de bombas, luces, ventiladores y otros actuadores es responsabilidad total del usuario.
                La Aplicación no se hace responsable de:
                <br>• Daños a cultivos por configuraciones incorrectas.
                <br>• Riesgos eléctricos o mecánicos.
                <br>• Pérdidas económicas derivadas del mal uso del sistema.
            </p>

            <h3 class="font-semibold text-teal-500">6. Propiedad Intelectual</h3>
            <p class="text-justify">
                Todo el contenido de la Aplicación —incluyendo software, diseño, documentación, base de datos,
                interfaz y elementos visuales— es propiedad del equipo desarrollador. Se prohíbe su copia,
                modificación y uso no autorizado.
            </p>

            <h3 class="font-semibold text-teal-500">7. Suspensión o Terminación de Cuenta</h3>
            <p class="text-justify">
                La Aplicación puede suspender o eliminar cuentas que incumplan los Términos,
                presenten actividad sospechosa o representen un riesgo para la seguridad.
            </p>

            <h3 class="font-semibold text-teal-500">8. Modificaciones de los Términos</h3>
            <p class="text-justify">
                Se reserva el derecho de modificar estos Términos y Condiciones en cualquier momento.
                Los cambios serán notificados dentro de la Aplicación. El uso continuo implica aceptación de los nuevos términos.
            </p>

            <h3 class="font-semibold text-teal-500">9. Jurisdicción Aplicable</h3>
            <p class="text-justify">
                Los presentes Términos se rigen por las leyes vigentes en el país donde se distribuye la
                Aplicación. Cualquier controversia será resuelta ante las autoridades competentes.
            </p>

            <h3 class="font-semibold text-teal-500">10. Contacto</h3>
            <p class="text-justify">
                Para dudas, aclaraciones o solicitudes relacionadas con estos Términos, el usuario podrá
                comunicarse al correo oficial disponible dentro de la Aplicación.
            </p>
        </div>

        <div class="flex justify-end px-5 pb-4">
            <button type="button"
                    class="inline-flex items-center rounded-lg px-4 py-2 text-sm font-semibold
                           bg-teal-500 text-slate-900 hover:bg-teal-400
                           focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2
                           focus:ring-offset-slate-900/0"
                    data-modal-close="modal-terms">
                Cerrar
            </button>
        </div>
    </div>
</div>

<div id="modal-privacy"
     data-modal-overlay
     class="hidden fixed inset-0 z-40 flex items-center justify-center px-4 py-6 bg-black/60 dark:bg-black/70">
    <div class="w-full max-w-2xl rounded-2xl border border-teal-400/70 bg-white dark:bg-slate-900 shadow-xl">
        <div class="flex items-start justify-between px-5 pt-4 pb-2">
            <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-50">
                Políticas de Privacidad
            </h2>
            <button type="button"
                    class="ml-3 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"
                    data-modal-close="modal-privacy">
                <span class="sr-only">Cerrar</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2">
                    <path d="M6 6l12 12M18 6L6 18"/>
                </svg>
            </button>
        </div>

        <div class="px-5 pb-4 max-h-72 overflow-y-auto text-sm leading-relaxed text-slate-700 dark:text-slate-200 space-y-3">
            <p class="text-justify">
                La presente Política de Privacidad establece los términos bajo los cuales
                Hydroponic System App (en adelante, “la Aplicación”) trata la información
                personal de sus usuarios. Este documento se formula conforme a principios de
                transparencia, seguridad y responsabilidad en el uso de datos.
            </p>

            <h3 class="font-semibold text-teal-500">1. Finalidad del Tratamiento de Datos</h3>
            <p class="text-justify">
                La Aplicación proporciona herramientas para monitorear y gestionar sistemas hidropónicos.
                Para ofrecer estos servicios, es necesario recopilar y procesar ciertos datos que permiten
                el funcionamiento adecuado del sistema, la visualización de mediciones en tiempo real
                y la interacción con los actuadores del cultivo.
            </p>

            <h3 class="font-semibold text-teal-500">2. Datos Recopilados</h3>
            <p class="text-justify">
                La Aplicación recopila la información indispensable para la prestación del servicio:
                <br>• Datos de identificación: correo electrónico, nombre de usuario y contraseña cifrada.
                <br>• Información del sistema hidropónico: lecturas de sensores (pH, ORP, temperatura,
                humedad, nivel de agua), historial de riego y consumo de nutrientes.
                <br>• Registros de actuadores: estados de bombas, ventiladores, lámparas u otros dispositivos.
                <br>• Información técnica: dirección IP, tipo de dispositivo y datos de registro de uso.
            </p>

            <h3 class="font-semibold text-teal-500">3. Uso de la Información</h3>
            <p class="text-justify">
                La información recopilada se utiliza para:
                <br>• Mantener el funcionamiento del sistema hidropónico.
                <br>• Sincronizar datos entre el dispositivo del usuario, el servidor y la base de datos.
                <br>• Generar notificaciones relacionadas con mediciones críticas o alertas del cultivo.
                <br>• Mejorar la experiencia de uso, el rendimiento y la estabilidad de la Aplicación.
            </p>

            <h3 class="font-semibold text-teal-500">4. Medidas de Seguridad</h3>
            <p class="text-justify">
                Se adoptan medidas técnicas y administrativas razonables para proteger los datos personales,
                incluyendo cifrado de contraseñas (bcrypt), controles de acceso y almacenamiento protegido.
                Ningún sistema es completamente infalible, pero se aplican medidas proporcionales a los riesgos.
            </p>

            <h3 class="font-semibold text-teal-500">5. Transferencia de Información</h3>
            <p class="text-justify">
                Los datos del usuario no serán vendidos, compartidos ni cedidos a terceros con fines comerciales.
                Solo podrán ser transferidos cuando sea necesario para garantizar el almacenamiento seguro del servicio
                o exista un requerimiento legal emitido por autoridades competentes.
            </p>

            <h3 class="font-semibold text-teal-500">6. Derechos del Usuario</h3>
            <p class="text-justify">
                El usuario podrá ejercer los derechos de acceso, rectificación, actualización y
                eliminación de sus datos personales. Podrá retirar su consentimiento eliminando su cuenta.
            </p>

            <h3 class="font-semibold text-teal-500">7. Responsabilidad del Usuario</h3>
            <p class="text-justify">
                El usuario es responsable de mantener la confidencialidad de sus credenciales y de garantizar
                que los datos proporcionados sean veraces y actuales.
            </p>

            <h3 class="font-semibold text-teal-500">8. Funcionamiento y Conectividad</h3>
            <p class="text-justify">
                El funcionamiento de la Aplicación depende del acceso a Internet. No se asume responsabilidad
                por interrupciones derivadas de fallos de red o configuraciones incorrectas del usuario.
            </p>

            <h3 class="font-semibold text-teal-500">9. Limitación de Responsabilidad</h3>
            <p class="text-justify">
                La Aplicación actúa como herramienta de apoyo para el monitoreo del sistema hidropónico.
                No se asume responsabilidad por daños causados por configuraciones incorrectas, fallos
                externos o riesgos derivados del uso de bombas, lámparas, ventiladores u otros actuadores.
            </p>

            <h3 class="font-semibold text-teal-500">10. Propiedad Intelectual</h3>
            <p class="text-justify">
                Todo el contenido, diseño, código fuente, interfaz gráfica y documentación de la Aplicación
                son propiedad del equipo desarrollador. Se prohíbe su reproducción, modificación o distribución
                sin autorización previa por escrito.
            </p>

            <h3 class="font-semibold text-teal-500">11. Actualizaciones de la Política</h3>
            <p class="text-justify">
                Esta Política podrá modificarse para adecuarla a cambios tecnológicos, legales o funcionales.
                Cualquier modificación será comunicada al usuario mediante la Aplicación.
            </p>

            <h3 class="font-semibold text-teal-500">12. Contacto y Retroalimentación</h3>
            <p class="text-justify">
                Para ejercer sus derechos o solicitar información adicional sobre esta Política, el usuario
                podrá comunicarse con el equipo de soporte a través del correo proporcionado en la Aplicación.
            </p>
        </div>

        <div class="flex justify-end px-5 pb-4">
            <button type="button"
                    class="inline-flex items-center rounded-lg px-4 py-2 text-sm font-semibold
                           bg-teal-500 text-slate-900 hover:bg-teal-400
                           focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2
                           focus:ring-offset-slate-900/0"
                    data-modal-close="modal-privacy">
                Cerrar
            </button>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // --- Modales: abrir/cerrar ---
    document.querySelectorAll('[data-modal-open]').forEach((btn) => {
        btn.addEventListener('click', () => {
            const id = btn.getAttribute('data-modal-open');
            const modal = document.getElementById(id);
            if (modal) modal.classList.remove('hidden');
        });
    });

    document.querySelectorAll('[data-modal-close]').forEach((btn) => {
        btn.addEventListener('click', () => {
            const id = btn.getAttribute('data-modal-close');
            const modal = document.getElementById(id);
            if (modal) modal.classList.add('hidden');
        });
    });

    document.querySelectorAll('[data-modal-overlay]').forEach((overlay) => {
        overlay.addEventListener('click', (event) => {
            if (event.target === overlay) {
                overlay.classList.add('hidden');
            }
        });
    });

    // --- Checks legales por formulario ---
    document.querySelectorAll('form[data-requires-legal="true"]').forEach((form) => {
        const submitBtn = form.querySelector('[data-submit-button]');
        const chkAll = form.querySelector('[data-accept-all]');
        const chkTerms = form.querySelector('[data-accept-terms]');
        const chkPrivacy = form.querySelector('[data-accept-privacy]');
        const errorText = form.querySelector('[data-accept-error]');

        if (!submitBtn || !chkAll || !chkTerms || !chkPrivacy) return;

        function allAccepted() {
            return chkTerms.checked && chkPrivacy.checked;
        }

        function updateState(showError = false) {
            const ok = allAccepted();

            submitBtn.disabled = !ok;
            submitBtn.classList.toggle('opacity-60', !ok);
            submitBtn.classList.toggle('cursor-not-allowed', !ok);

            chkAll.checked = ok;

            if (errorText) {
                if (showError && !ok) {
                    errorText.classList.remove('hidden');
                } else {
                    errorText.classList.add('hidden');
                }
            }
        }

        chkAll.addEventListener('change', () => {
            chkTerms.checked = chkAll.checked;
            chkPrivacy.checked = chkAll.checked;
            updateState(false);
        });

        chkTerms.addEventListener('change', () => updateState(false));
        chkPrivacy.addEventListener('change', () => updateState(false));

        form.addEventListener('submit', (e) => {
            if (!allAccepted()) {
                e.preventDefault();
                updateState(true);
            }
        });

        // Estado inicial
        updateState(false);
    });
});
</script>